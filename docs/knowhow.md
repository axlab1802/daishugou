# 実装中のつまづき・解決メモ

## 1. トランプの雰囲気が出にくい
**課題**: 単純な矩形カードだとゲームの雰囲気が弱く見えた。
**対応**: 角にランクを配置し、枠線と内側の薄い光沢レイヤーを追加。

## 2. 中央の「中世風の油絵」表現
**課題**: 実画像を使わずに油絵感を出す必要があった。
**対応**: 木枠風グラデーション + 文字配置で「絵画フレーム」を演出。

## 3. コンボ判定の整合性
**課題**: 異なるランクを含むコンボを場に出した後、通常判定で比較できない問題。
**対応**: 場の状態に `fieldMeta` を持たせ、コンボ時は「最大ランク」を比較基準にしてゲーム進行が止まらないようにした。

## 4. オンライン同期の最小構成
**課題**: 追加ライブラリなしでロビーとAPIを実装する必要があった。
**対応**: Node.js標準のHTTPサーバーでAPIと静的配信をまとめ、ポーリングで状態同期する構成にした。

## 5. カードレイアウトの一括変更
**課題**: SVGを手編集すると差分が増えやすい。
**対応**: `tools/card_layout.json` にレイアウト値を集約し、生成スクリプトで一括反映できるようにした。

## 6. ジョーカー追加の見落とし
**課題**: ローカル用の `main.js` とオンライン用の `server.js` が別々にデッキ生成しており、片方だけ修正すると挙動がずれる。
**対応**: 両方に `JOKER_RANK` / `JOKER_CARD` を追加し、強さ判定も共通で最上位になるように分岐を入れた。

## 7. 効果音ファイルの準備
**課題**: 環境差で音声ファイル形式が揃わないことがある。
**対応**: `assets/sfx/sfx.json` に割り当てを集約し、まずは `.wav` を生成して動作確認できるようにした。
